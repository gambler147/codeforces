Identify the Operations

We start with a permutation ğ‘1,ğ‘2,â€¦,ğ‘ğ‘› and with an empty array ğ‘. We apply
the following operation ğ‘˜ times.

On the ğ‘–-th iteration, we select an index ğ‘¡ğ‘– (1â‰¤ğ‘¡ğ‘–â‰¤ğ‘›âˆ’ğ‘–+1), remove ğ‘ğ‘¡ğ‘–
from the array, and append one of the numbers ğ‘ğ‘¡ğ‘–âˆ’1 or ğ‘ğ‘¡ğ‘–+1 (if ğ‘¡ğ‘–âˆ’1 or
ğ‘¡ğ‘–+1 are within the array bounds) to the right end of the array ğ‘. Then we
move elements ğ‘ğ‘¡ğ‘–+1,â€¦,ğ‘ğ‘› to the left in order to fill in the empty space.

You are given the initial permutation ğ‘1,ğ‘2,â€¦,ğ‘ğ‘› and the resulting array
ğ‘1,ğ‘2,â€¦,ğ‘ğ‘˜. All elements of an array ğ‘ are distinct. Calculate the number
of possible sequences of indices ğ‘¡1,ğ‘¡2,â€¦,ğ‘¡ğ‘˜ modulo 998244353.

Input Each test contains multiple test cases. The first line contains an integer
ğ‘¡ (1â‰¤ğ‘¡â‰¤100000), denoting the number of test cases, followed by a description
of the test cases.

The first line of each test case contains two integers ğ‘›,ğ‘˜ (1â‰¤ğ‘˜<ğ‘›â‰¤200000):
sizes of arrays ğ‘ and ğ‘.

The second line of each test case contains ğ‘› integers ğ‘1,ğ‘2,â€¦,ğ‘ğ‘›
(1â‰¤ğ‘ğ‘–â‰¤ğ‘›): elements of ğ‘. All elements of ğ‘ are distinct.

The third line of each test case contains ğ‘˜ integers ğ‘1,ğ‘2,â€¦,ğ‘ğ‘˜
(1â‰¤ğ‘ğ‘–â‰¤ğ‘›): elements of ğ‘. All elements of ğ‘ are distinct.

The sum of all ğ‘› among all test cases is guaranteed to not exceed 200000.

Output For each test case print one integer: the number of possible sequences
modulo 998244353.

Example inputCopy 3 5 3 1 2 3 4 5 3 2 5 4 3 4 3 2 1 4 3 1 7 4 1 4 7 3 6 2 5 3 2
4 5 outputCopy 2 0 4